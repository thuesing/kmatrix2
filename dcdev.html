<script type="text/javascript" src="https://rawgithub.com/NickQiZhu/dc.js/master/web/js/crossfilter.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src='components/dc.js' type='text/javascript'></script>
<script>
var data;
var test;
// Load data
d3.csv("data/dev.csv", function(error, data) {
    if(error) console.log(error);
    data = parseData(data);
    //console.log(data);

    var cf = crossfilter(data);

    var tags = cf.dimension(function(d){ return d.zsektor;});
    var tagsGroup = tags.group();


    dc.rowChart("#chart")
        .renderLabel(true)
        .dimension(tags)
        .group(tagsGroup)
        .xAxis().ticks(3);

    dc.renderAll();


    /*
    var ndx = crossfilter(data);
    var nameDim  = ndx.dimension(function(d) {return d.zname;});
    test = nameDim.filter("THG-Emissionsreduktion allgemein"); 
    print_filter("test"); 
    */
    //var totalDim = ndx.dimension(function(d) { return d.total; });   
    //var total_90 = totalDim.filterExact(90); 
    //print_filter("total_90"); 
}); // d3.csv call


function print_filter(filter){
	var f=eval(filter);
	if (typeof(f.length) != "undefined") {}else{}
	if (typeof(f.top) != "undefined") {f=f.top(Infinity);}else{}
	if (typeof(f.dimension) != "undefined") {f=f.dimension(function(d) { return "";}).top(Infinity);}else{}
	console.log(filter+"("+f.length+") = "+JSON.stringify(f).replace("[","[\n\t").replace(/}\,/g,"},\n\t").replace("]","\n]"));
} 



function parseData(data) { // from d3.csv
    var res = [];

    data.forEach(function (d) {

        var row = {zname: d.zname,zsektor: d.zsektor ,mname: d.mname,vname: d.vname,vudescr: d.vudescr,uname: d.uname,pname: d.pname,zename: d.zename,zesektor: d.zesektor};
        res.push(row);

    });

    return res;
} // parseData



</script>

<div id="chart"></div>

<div id="chart2"></div>